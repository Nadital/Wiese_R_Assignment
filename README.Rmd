---
title: "R Assignment Notebook"
output: html_notebook
---

# R Assignment Wiese

Inspection, processing, and visualization of data from a paper.  Worth noting, before I start this, that I had a few difficulties even getting R markdown to work properly on my computer.  Had to redownload R and reinstall Rcpp again to get it functioning.


## Data Inspection
1. Initial step is simply copying the necessary files (fang_et_al_genotypes.txt and snp_position.txt) to the repository for this project.
2. Second part is just translating the files into objects for R after getting basic file info.  Pretty easy to do.  Can then look at stuff like number of rows and columns.

```{r}
# Utility functions exist to check file size.
file.size("fang_et_al_genotypes.txt")
file.size("snp_position.txt")
fang <- read.csv("fang_et_al_genotypes.txt", sep="\t")
snp <- read.csv("snp_position.txt", sep="\t")
# Dim returns number of rows, then number of columns.
dim(fang)
dim(snp)
# Size of files makes str() a bit unwieldly, and our fang object is a bit too much for just looking at the header.  Cutting it down a bit on rows and columns helps some, though, and still gives us a decent general idea.  
fang[1:5,1:5]
snp[1:5,1:5]
```
We see that the filesize for fang_et_al_genotypes.txt is 11054722 bytes, with 2782 rows and 986 columns.  snp_position.txt is 83747 bytes, with 983 rows and 15 columns.

## Data Processing
Data examined, we are now ready to process it for analysis.

1.  First step is to create distinct maize (ZMMIL, ZMMLR, and ZMMMR) and teosinate (ZMPBA, ZMPIL, and ZMPJA) genotype objects.  Can then transpose them for use when merging.

```{r}
m_geno <- subset(fang, Group == "ZMMIL" | Group == "ZMMLR" | Group == "ZMMMR")
t_geno <- subset(fang, Group == "ZMPBA" | Group == "ZMPIL" | Group == "ZMPJA")
trans_m_geno <- t(m_geno)
trans_t_geno <- t(t_geno)
# Actually almost forgot this, am kinda glad I went back and checked.  The transposed genotype files apparently aren't treated as data frames, so.
trans_m_geno <- as.data.frame(trans_m_geno)
trans_t_geno <- as.data.frame(trans_t_geno)
# This last bit is just to show it worked, basically.  Not really the best method for doing so, but it's the one I like to use.  Tend to observe different rows/columns this way before calling it good.
trans_m_geno[1:5,1:5]
```
Bit of an aside, but an upshot of this method versus the method we used with git--at least, the way I did it--is the creation of far fewer intermediate files to flood the repository.

Now we need to remove the first three rows of the transposed data in order to get it into a state for merging.  Don't really need the column names for these, anymore.  Do, however, need to give one column in each the name SNP_ID, in order to make it fit for merging.

```{r}
trans_m_geno <- trans_m_geno[-c(1:3),]
trans_t_geno <- trans_t_geno[-c(1:3),]
trans_m_geno$SNP_ID <- rownames(trans_m_geno)
trans_t_geno$SNP_ID <- rownames(trans_t_geno)
# Once again, to demonstrate this worked.
trans_m_geno$SNP_ID[1:10]
```

## Data Visualization